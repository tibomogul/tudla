<div class="mt-6">
  <%= render partial: "pages/projects_list_frame", locals: {
    pagy_projects: @pagy_projects,
    projects: @projects,
    project_name_filter: params[:project_name]
  } %>
</div>

<div class="mt-6">
  <div class="flex items-center justify-between">
    <p class="text-xl font-semibold">My Day</p>
  </div>
  <div class="mt-4 grid grid-cols-1 gap-6 xl:grid-cols-5">
    <div class="xl:col-span-3">
      <div class="flex items-center justify-between mb-2">
        <h2 class="text-lg font-medium">Today's List (<span id="today_count"><%= @today_tasks.size %></span>)</h2>
      </div>
      <%= render "pages/today_list" %>
      <div class="mt-4">
        <details class="collapse collapse-arrow bg-base-100 shadow">
          <summary class="collapse-title text-md font-medium">Completed Today (<span id="completed_today_count"><%= @completed_today_tasks.size %></span>)</summary>
          <div class="collapse-content">
            <%= render "pages/completed_today_list" %>
          </div>
        </details>
      </div>
    </div>
    <div class="xl:col-span-2">
      <div class="flex items-center justify-between mb-2">
        <h2 class="text-lg font-medium">My Task Backlog (<span id="backlog_count"><%= @backlog_tasks.size %></span>)</h2>
      </div>
      <%= render "pages/backlog_list" %>
    </div>
  </div>
</div>

<% TudlaContracts::Integrations::Registry.views_for_slot("dashboard_section").each do |tab_def| %>
  <div class="mt-6 grid grid-cols-12 gap-6">
    <div class="col-span-12">
      <div class="card bg-base-100 shadow">
        <div class="card-body px-0 pb-0">
          <div class="flex items-center justify-between mb-2">
            <h2 class="text-lg font-medium"><%= tab_def.label %></h2>
          </div>
          <%= render tab_def.component_class.new(user_id: current_user.id) %>
        </div>
      </div>
    </div>
  </div>
<% end %>
